(()=>{"use strict";var e,t={494:()=>{const e=window.wp.hooks,t=window.wp.element,o=window.prcComponents,r=window.wp.i18n,i=window.wp.primitives,n=window.ReactJSXRuntime,l=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"M19 3H5c-.6 0-1 .4-1 1v7c0 .5.4 1 1 1h14c.5 0 1-.4 1-1V4c0-.6-.4-1-1-1zM5.5 10.5v-.4l1.8-1.3 1.3.8c.3.2.7.2.9-.1L11 8.1l2.4 2.4H5.5zm13 0h-2.9l-4-4c-.3-.3-.8-.3-1.1 0L8.9 8l-1.2-.8c-.3-.2-.6-.2-.9 0l-1.3 1V4.5h13v6zM4 20h9v-1.5H4V20zm0-4h16v-1.5H4V16z"})}),s=window.prcHooks,a=window.wp.coreData,c=window.wp.data,d=(0,t.createContext)();function p(e,t){return e.sizes[t]?{id:e.id,rawUrl:e.url,url:e.sizes[t].url,width:e.sizes[t].width,height:e.sizes[t].height,caption:e.caption,chartArt:!1}:(console.error(`No image size found for ${t}`,e),!1)}const g=()=>(0,t.useContext)(d);function h({children:e}){const o=(()=>{const{postId:e,postType:o,testMeta:r}=(0,c.useSelect)((e=>({postId:e("core/editor").getCurrentPostId(),postType:e("core/editor").getCurrentPostType(),testMeta:e("core/editor").getCurrentPostAttribute("meta")})),[]),[i,n]=(0,a.useEntityProp)("postType",o,"meta",e),{canDelete:l,isResolving:d}=(0,a.useResourcePermissions)(o,e),g=(0,t.useMemo)((()=>(console.log("ART CHECK Permissions Check:",d,l),!d)),[d,l]),[h,m]=(0,t.useState)(i.artDirection||{}),u=(0,s.useDebounce)(h,500);(0,t.useEffect)((()=>{console.log("ART DIRECTION:",i,r,u,i.artDirection,h,g),g&&void 0!==i?(u.A1&&!1!==u.A1&&(function(e=!1){if(!1!==e){const{editPost:t}=(0,c.dispatch)("core/editor");t({featured_media:e.id})}}(u.A1),console.log("Featured Image: ",u.A1)),JSON.stringify(u)!==JSON.stringify(i.artDirection)?(console.log("Art Direction Change Detected",u,i),console.log("ART DIRECTION UPDATE: ",u,i),n({...i,artDirection:u})):console.log("No Art Direction Change Detected",u,i.artDirection)):console.log("ART DIRECTION UHOH: Can't edit or no meta",g,i)}),[u,g,i,n]);const x=(0,t.useMemo)((()=>!!h.A1),[h]),A=(0,t.useMemo)((()=>{const e=Object.keys(u),t=u[e[0]];console.log("allSlotsTheSame",e,t);for(let o=1;o<e.length;o++){console.log("allSlotsTheSame...",t,u[e[o]]);let r=0;if(t.id!==u[e[o]].id&&(r+=1),t.chartArt!==u[e[o]].chartArt&&(r+=1),r>0)return console.log("allSlotsTheSame...","not all the same"),!1}return console.log("allSlotsTheSame...","all the same"),!0}),[u]);return{allowEditing:g,postId:e,postType:o,artDirection:u,hasA1Image:x,setImageSlot:(e,t)=>{const o=function(e,t){const o={};return"A1"===t&&(o.A2=p(e,"A2"),o.XL=p(e,"XL"),o.facebook=p(e,"facebook"),o.twitter=p(e,"twitter")),"A1"!==t&&"A2"!==t||(o.A3=p(e,"A3"),o.A4=p(e,"A4")),"facebook"===t&&(o.twitter=p(e,"twitter")),o[t]=p(e,t),o}(e,t);m({...h,...o})},getImageSlot:e=>h?.[e],isImageSlotBordered:e=>h?.[e]?.chartArt,toggleImageSlotBordered:e=>{let t={...h};t=function(e={},t){const o=!e[t].chartArt;return"A2"===t?(e.A2.chartArt=o,e.A3.chartArt=o,e.A4.chartArt=o):e[t].chartArt=o,console.log("prc-platform/art-direction propagateBorderedToggle::",e),e}(t,e),m({...t})},capitalize:e=>"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1),allSlotsTheSame:A}})();return(0,n.jsx)(d.Provider,{value:o,children:e})}const m=window.wp.components;function u({label:e,size:o}){const{isImageSlotBordered:r,toggleImageSlotBordered:i,capitalize:l}=g(),s=r(o),a=(0,t.useMemo)((()=>e||l(o)),[e,o,l]);return(0,n.jsxs)(m.Flex,{style:{alignItems:"center",borderTop:"1px solid #eaeaea",height:"45px"},children:[(0,n.jsx)(m.FlexBlock,{children:(0,n.jsx)("strong",{children:a})}),(0,n.jsx)(m.FlexItem,{children:("A2"===o||"A3"===o||"A4"===o)&&(0,n.jsx)(m.ToggleControl,{__nextHasNoMarginBottom:!0,label:"Border",onChange:()=>i(o),checked:s})})]})}function x({size:e,labels:r,onClick:i,overlayActive:l,enableLabel:s=!0}){const{getImageSlot:a,setImageSlot:c,capitalize:d}=g(),p=(0,t.useMemo)((()=>a(e)),[e,a]),h=(0,t.useMemo)((()=>p?p.id:null),[p]),m=d(e);return(0,n.jsxs)("div",{className:"prc-platform-art-direction__slot",children:[s&&(0,n.jsx)(u,{label:r?.label||`${m}`,size:e}),(0,n.jsx)(o.MediaImageSlot,{id:h,size:e,labels:r||{label:`Edit ${m} Image Slot`,title:`Select ${m} Image`,update:`Update ${m} Image Slot`,dropzone:`Drop ${m}`},onUpdate:t=>{c(t,e)},onClick:i,overlayActive:l})]})}function A(){const{hasA1Image:e}=g();return(0,n.jsxs)("div",{className:"prc-platform-art-direction__list",children:[(0,n.jsx)("p",{children:(0,n.jsx)(m.ExternalLink,{href:"https://platform.pewresearch.org/wiki/art-direction",children:"Art Direction Documentation"})}),(0,n.jsx)("p",{style:{background:"var(--wp--custom--color-grey-spectrum-light-one)",padding:"0.5em 1em",marginLeft:"-1em",marginRight:"-1em",marginTop:"1em",marginBottom:"-1px"},children:(0,n.jsx)("strong",{children:"Story Item"})}),(0,n.jsx)(x,{size:"A1"}),e&&(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(x,{size:"A2"}),(0,n.jsxs)(m.Flex,{children:[(0,n.jsx)(m.FlexBlock,{children:(0,n.jsx)(x,{size:"A3"})}),(0,n.jsx)(m.FlexBlock,{children:(0,n.jsx)(x,{size:"A4"})})]}),(0,n.jsx)("p",{style:{background:"var(--wp--custom--color-grey-spectrum-light-one)",padding:"0.5em 1em",marginLeft:"-1em",marginRight:"-1em",marginTop:"1em",marginBottom:"-1px"},children:(0,n.jsx)("strong",{children:"Social"})}),(0,n.jsxs)(m.Flex,{children:[(0,n.jsx)(m.FlexBlock,{children:(0,n.jsx)(x,{size:"facebook"})}),(0,n.jsx)(m.FlexBlock,{children:(0,n.jsx)(x,{size:"twitter"})})]})]})]})}function w(){const{hasA1Image:e,allSlotsTheSame:t}=g();return(0,n.jsx)(o.InspectorPopoutPanel,{title:(0,r.__)("Art Direction"),className:"prc-platform-art-direction-panel",renderToggle:({isOpen:o,onToggle:r})=>(0,n.jsx)(x,{size:"A1",labels:{label:"Setup Art Direction",title:"Select Art Direction Image",update:t?"Update Art Direction":"Update Art Direction (Some Slots Differ)",dropzone:"Drop A1 Image",icon:l},onClick:e?r:void 0,enableLabel:!1,overlayActive:o}),children:(0,n.jsx)(A,{})})}function f(){return(0,n.jsx)(h,{children:(0,n.jsx)(w,{})})}const j=window.wp.editPost;function v(){return(0,n.jsx)(j.PluginPrePublishPanel,{title:"Review Art Direction",initialOpen:!0,children:(0,n.jsx)(h,{children:(0,n.jsx)(A,{})})})}(0,e.addFilter)("editor.PostFeaturedImage","prc-platform/art-direction",(function(){return()=>(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(f,{}),(0,n.jsx)(v,{})]})})),(0,e.addFilter)("prc-platform.attachments-panel","prc-platform/art-direction",(function(e){return()=>(0,n.jsxs)(t.Fragment,{children:[(0,n.jsx)(e,{}),(0,n.jsx)(h,{children:(0,n.jsx)(m.PanelBody,{title:"Art Direction",initialOpen:!1,children:(0,n.jsx)(A,{})})})]})}))}},o={};function r(e){var i=o[e];if(void 0!==i)return i.exports;var n=o[e]={exports:{}};return t[e](n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,o,i,n)=>{if(!o){var l=1/0;for(d=0;d<e.length;d++){for(var[o,i,n]=e[d],s=!0,a=0;a<o.length;a++)(!1&n||l>=n)&&Object.keys(r.O).every((e=>r.O[e](o[a])))?o.splice(a--,1):(s=!1,n<l&&(l=n));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,i,n]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var i,n,[l,s,a]=o,c=0;if(l.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(a)var d=a(r)}for(t&&t(o);c<l.length;c++)n=l[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},o=globalThis.webpackChunk_pewresearch_art_direction=globalThis.webpackChunk_pewresearch_art_direction||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var i=r.O(void 0,[350],(()=>r(494)));i=r.O(i)})();
//# sourceMappingURL=index.js.map